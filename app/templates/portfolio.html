{% extends "base.html" %}

{% block title %}Portfolio - Chouchouter By Nanou{% endblock %}

{% block head %}
   <link rel="stylesheet" href="{{ url_for('static', filename='portfolio.css') }}">
   <style>
     /* Lightbox styles basiques */
     .lightbox-overlay {
       position: fixed;
       top: 0; left: 0; right: 0; bottom: 0;
       background: rgba(0,0,0,0.8);
       display: flex;
       justify-content: center;
       align-items: center;
       z-index: 9999;
       visibility: hidden;
       opacity: 0;
       transition: opacity 0.3s ease;
     }
     .lightbox-overlay.visible {
       visibility: visible;
       opacity: 1;
     }
     .lightbox-content {
       position: relative;
       max-width: 90%;
       max-height: 90%;
     }
     .lightbox-content img {
       max-width: 100%;
       max-height: 100%;
       border-radius: 4px;
     }
     .lightbox-close {
       position: fixed;
       top: 20px;
       right: 20px;
       background: rgba(255,255,255,0.7);
       border: none;
       padding: 10px 15px;
       cursor: pointer;
       border-radius: 50%;
       font-size: 25px;
       user-select: none;
     }
   </style>
{% endblock %}

{% block content %}


<div class="photo-grid">
    {% for image_path in images %}
        <img class="photo" src="{{ url_for('static', filename=image_path) }}" alt="photo {{ loop.index }}">
    {% else %}
        <p>Aucune image disponible pour le moment.</p>
    {% endfor %}
</div>

<!-- Lightbox HTML -->
<div class="lightbox-overlay" id="lightbox">
  <button class="lightbox-close" id="lightbox-close">&times;</button>
  <div class="lightbox-content">
    <img src="" alt="Photo agrandie" id="lightbox-img">
  </div>
</div>

<script>
  (() => {
    const images = [...document.querySelectorAll('.photo-grid .photo')];
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    const closeBtn = document.getElementById('lightbox-close');

    function showLightbox(index) {
      lightboxImg.src = images[index].src;
      lightbox.classList.add('visible');
    }

    function hideLightbox() {
      lightbox.classList.remove('visible');
      lightboxImg.src = '';
    }

    // Click sur une photo pour ouvrir la lightbox
    images.forEach((img, idx) => {
      img.addEventListener('click', () => showLightbox(idx));
    });

    // Bouton fermeture
    closeBtn.addEventListener('click', hideLightbox);

    // Fermer la lightbox si clic en dehors de l'image
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        hideLightbox();
      }
    });

    // Fermeture clavier (touche Ã‰chap)
    document.addEventListener('keydown', (e) => {
      if (!lightbox.classList.contains('visible')) return;
      if (e.key === 'Escape') {
        hideLightbox();
      }
    });
  })();
</script>

{% endblock %}